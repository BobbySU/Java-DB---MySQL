1.
DELIMITER ### 
CREATE PROCEDURE usp_get_employees_salary_above_35000 ()
BEGIN
SELECT first_name, last_name FROM employees
WHERE salary > 35000
ORDER BY first_name, last_name, employee_id;
END
###



2.
DELIMITER ### 
CREATE PROCEDURE usp_get_employees_salary_above (salary_in DOUBLE(9,4))
BEGIN
SELECT first_name, last_name FROM employees
WHERE salary >= salary_in
ORDER BY first_name, last_name, employee_id;
END
###


3.
DELIMITER ### 
CREATE PROCEDURE usp_get_towns_starting_with (start_name TEXT)
BEGIN
SELECT `name` AS town_name FROM towns
WHERE `name` LIKE CONCAT(start_name,'%')
ORDER BY town_name;
END
###
DELIMITER ;


4.
DELIMITER ### 
CREATE PROCEDURE usp_get_employees_from_town (town_name VARCHAR(50))
BEGIN
SELECT e.first_name, e.last_name FROM employees AS e 
JOIN addresses AS a ON e.address_id = a.address_id
JOIN towns AS t ON a.town_id = t.town_id
WHERE t.`name` LIKE town_name
ORDER BY e.first_name, e.last_name, e.employee_id;
END
###
DELIMITER ;


5.
DELIMITER ### 
CREATE FUNCTION ufn_get_salary_level (salary DOUBLE)
RETURNS VARCHAR(10)
DETERMINISTIC 
BEGIN
RETURN (CASE
WHEN salary < 30000 THEN 'Low'
WHEN salary <= 50000 THEN 'Average'
ELSE 'High'
END
);
END
###
DELIMITER ;


6.
DELIMITER ### 
CREATE FUNCTION ufn_get_salary_level (salary DOUBLE)
RETURNS VARCHAR(10)
DETERMINISTIC 
BEGIN
RETURN (CASE
WHEN salary < 30000 THEN 'Low'
WHEN salary <= 50000 THEN 'Average'
ELSE 'High'
END
);
END;
###
DELIMITER ;

DELIMITER ### 
CREATE PROCEDURE usp_get_employees_by_salary_level (salary_level VARCHAR(50))
BEGIN
SELECT first_name, last_name FROM employees 
WHERE ufn_get_salary_level(salary) = salary_level
ORDER BY first_name DESC, last_name DESC;
END;
###
DELIMITER ;


7.
DELIMITER ### 
CREATE FUNCTION ufn_is_word_comprised (set_of_letters varchar(50), word varchar(50))
RETURNS BIT
DETERMINISTIC 
BEGIN
RETURN word REGEXP(CONCAT('^[', set_of_letters, ']+$'));
END;
###
DELIMITER ; 


8.
DELIMITER ### 
CREATE PROCEDURE usp_get_holders_full_name ()
BEGIN
SELECT CONCAT(first_name, ' ', last_name) AS full_name FROM account_holders
ORDER BY full_name, id;
END;
###
DELIMITER ;

9.
DELIMITER ### 
CREATE PROCEDURE usp_get_holders_with_balance_higher_than (number_in DOUBLE)
BEGIN
SELECT h.first_name, h.last_name FROM account_holders AS h
JOIN accounts AS a ON h.id = a.account_holder_id
GROUP BY h.id
HAVING SUM(a.balance) > number_in
ORDER BY h.id;
END;
###
DELIMITER ;


10.
DELIMITER ### 
CREATE FUNCTION ufn_calculate_future_value (initial_sum DECIMAL(10,4), rate DOUBLE, years INT)
RETURNS DECIMAL(10,4)
DETERMINISTIC 
BEGIN
RETURN initial_sum * (POW(1+rate, years));
END;
###
DELIMITER ; 


11.
DELIMITER ### 
CREATE FUNCTION ufn_calculate_future_value (initial_sum DECIMAL(10,4), rate DOUBLE, years INT)
RETURNS DECIMAL(10,4)
DETERMINISTIC 
BEGIN
RETURN initial_sum * (POW(1+rate, years));
END;
###
DELIMITER ; 

DELIMITER ### 
CREATE PROCEDURE usp_calculate_future_value_for_account (account_id INT, rate DECIMAL(10,4))
BEGIN
SELECT a.id AS 'account_id', h.first_name, h.last_name, a.balance AS 'current_balance', 
ufn_calculate_future_value(a.balance, rate, 5) AS 'balance_in_5_years'
FROM account_holders AS h
JOIN accounts AS a ON h.id = a.account_holder_id
WHERE a.id = account_id;
END;
###
DELIMITER ;


12.

